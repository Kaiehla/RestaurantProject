@model List<RestaurantTable>
@{
    ViewData["Title"] = "Table View";
}@{
    Layout = "_Layout-Admin";
}

@*Content Area*@
        <div class="col py-3 ms-3 me-3">
            <h3 class="fw-bold">@ViewData["Title"]</h3>
            <hr />
            <div class="col py-2 ms-3">
                @*Table*@
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">ID</th>
                            <th scope="col">Table Name</th>
                            <th scope="col" class="text-center">Seating Capacity </th>
                            <th scope="col" class="text-center">Available </th>
                            <th scope="col" class="text-center">Actions</th>
                        </tr>
                    </thead>


                    <tbody>
                        @{var count = 1;}
                        @foreach (var data in Model)
                        {
                            <tr>
                                <th scope="row">@count</th>
                                <td>@data.Id</td>
                                <td>@data.TableName</td>
                                <td class="text-center">@data.SeatingCapacity</td>
                                @{
                                    if (data.Availability == "Free")
                                    {
                                        <td class="text-center"><span class="badge rounded-pill text-bg-success bg-success">@data.Availability</span></td>
                                    }
                                    else
                                    {
                                        <td class="text-center"><span class="badge rounded-pill text-bg-success bg-danger">@data.Availability</span></td>
                                    }
                                }
                                <td class="text-center">
                                    @*Edit*@
                                    <a class="edit" data-bs-toggle="modal" data-bs-target="#editTable" data-id="@data.Id">
                                        <i class="bi bi-pencil text-success"></i>
                                    </a>

                                    @*Delete*@
                                    <a class="delete" data-bs-toggle="modal" data-bs-target="#deleteTable" data-id="@data.Id">
                                        <i class="bi bi-trash text-danger"></i>
                                    </a>
                                </td>
                            </tr>
                            count += 1;
                        }
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</div>


<!-- Edit Modal -->
<div class="modal fade" id="editTable" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <form asp-action="UpdateTable" method="post">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Edit Table Info</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                   
                </div>

                <div class="modal-footer">
                    <button class="btn btn-success-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button class="btn btn-success" type="submit">Update</button>
                </div>
            </div>
        </form>
    </div>
</div>
@*end of modal*@

<!-- Delete Modal -->
<div class="modal fade" id="deleteTable" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <form asp-action="DeleteTable" method="post">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Delete Table?</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    
                </div>

                <div class="modal-footer">
                    <button class="btn btn-danger-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button class="btn btn-danger" type="submit">Delete</button>
                </div>
            </div>
        </form>
    </div>
</div>


<!-- Error Modal -->
<div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Delete Table?</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                </div>

                <div class="modal-footer">
                    <button class="btn btn-danger-secondary" data-bs-dismiss="modal">Exit</button>
                </div>
            </div>
    </div>
</div>

@*end of overall*@

@section Scripts {
    <script>
        $(function () {
            $('a.edit').on('click', function () {
                var id = $(this).data("id")
                $.ajax({
                    url: `@Url.Action("TableDetails", "Table")`,
                    method: "GET",
                    data: { id: id },
                    success: function (data) {
                        $(".modal-body").html(data)
                    }
                })
            });
        })
        $(function () {
            $('a.delete').on('click', function () {
                var id = $(this).data("id")
                $.ajax({
                    url: `@Url.Action("TableDetailsViewOnly", "Table")`,
                    method: "GET",
                    data: { id: id },
                    success: function (data) {
                        $(".modal-body").html(data)
                    }
                })
            });
        })
    </script>
}