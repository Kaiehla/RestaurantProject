@model List<PackageMenu>
@{
    ViewData["Title"] = "Package View";
}
@{
    Layout = "_Layout-Admin";
}

@*Content Area*@
        <div class="col py-3 ms-3 me-3">
            <h3 class="fw-bold">@ViewData["Title"]</h3>
            <hr />

            @*Table*@
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">ID</th>
                        <th scope="col">Package Name</th> @*kunin yung equivalent firstname, ang ipapakita dito yung customer first name*@
                        <th scope="col">Package Description</th> @*kunin yung equivalent lastname, ang ipapakita dito yung customer last name*@
                        <th scope="col">Price</th> @*kunin yung equivalent email, ang ipapakita dito yung customer email*@
                        <th scope="col">Duration</th> @*kunin yung equivalent phone, ang ipapakita dito yung customer phone num*@
                        <th scope="col">Suitable For</th>
                        <th scope="col" class="text-center">Actions</th>
                    </tr>
                </thead>


                <tbody>
                    @{var count = 1;}
                    @foreach (var data in Model)
                    {
                        <tr>
                            <th scope="row">@count</th>
                            <td>@data.Id</td>
                            <td>@data.PackageName</td>
                            <td>@data.PackageDescription</td>
                            <td>@data.Price</td>
                            <td>@data.Duration Hours</td>   @*Imbis na INT gawin nalang na Time data type sa database?*@
                            <td>@data.RecommendedNumber</td>
                            <td class="text-center">
                                @*Edit*@
                                <a class="edit" data-bs-toggle="modal" data-bs-target="#editPackage" data-id="@data.Id">
                                    <i class="bi bi-pencil text-success"></i>
                                </a>

                                @*Delete*@
                                <a class="delete" data-bs-toggle="modal" data-bs-target="#delPackage" data-id="@data.Id">
                                    <i class="bi bi-trash text-danger"></i>
                                </a>
                            </td>
                        </tr>
                        count += 1;
                    }
                </tbody>
            </table>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal fade" id="editPackage" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <form asp-action="UpdatePackageMenu" method="post">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Edit Package Information</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-success-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-success">Update</button>
                </div>
            </div>
            </form>
        </div>
    </div>
    @*end of modal*@

    <!-- Delete Modal -->
    <div class="modal fade" id="delPackage" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <form asp-action="DeletePackageMenu" method="post">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Delete Package?</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn btn-danger-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Delete</button>
                </div>
            </div>
            </form>
        </div>
    </div>

    @*end of overall*@
<!-- Error Modal -->
<div class="modal fade" id="packageExists" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Error: Package Exists!</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h1>Package is in use!</h1>
                </div>
            </div>
    </div>
</div>

@section Scripts {
    <script>
        $(function () {
            $('a.edit').on('click', function () {
                console.log("text")
                var id = $(this).data("id")
                $.ajax({
                    url: `@Url.Action("PackageMenuDetails", "Package")`,
                    method: "GET",
                    data: { id: id },
                    success: function (data) {
                        $(".modal-body").html(data)
                    }
                })
            });
        })
        $(function () {
            $('a.delete').on('click', function () {
                var id = $(this).data("id")
                $.ajax({
                    url: `@Url.Action("PackageMenuDetailsViewOnly", "Package")`,
                    method: "GET",
                    data: { id: id },
                    success: function (data) {
                        $(".modal-body").html(data)
                    }
                })
            });
        })
        $(function () {
            $(document).ready(function () {
                if ('@TempData["PackageIsInUse"]') {
                    $('#packageExists').modal('show');
                }
            });
        })
    </script>
}